<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Levels</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<style>

body{
  background:#f5f7fb;
  font-family:system-ui;
}

/* header */
header{
  background:white;
  border-bottom:1px solid #eee;
}

/* level card */
.level-card{
  background:white;
  border-radius:50px;
  padding:12px 16px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  box-shadow:0 3px 10px rgba(0,0,0,0.05);
  transition:.25s;
}

.level-card:active{
  transform:scale(.97);
}

/* level number */
.level-num{
  width:60px;
  height:60px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  font-size:18px;
}

/* states */
.active{
  background:#4CAF50;
  color:white;
}

.locked{
  background:#e5e7eb;
  color:#9aa0a6;
}

.level-title{
  font-size:18px;
  font-weight:500;
}

/* progress dots */
.dot{
  width:8px;
  height:8px;
  border-radius:50%;
  margin:0 3px;
}

.dot-active{
  background:#4CAF50;
}

.dot-inactive{
  background:#d1d5db;
}

.arrow{
  color:#9aa0a6;
}

.lock{
  color:#9aa0a6;
  font-size:20px;
}

</style>
</head>

<body>

<header class="p-3 text-center d-flex align-items-center">
<button onclick="history.back()" class="btn btn-light">
  <i class="bi bi-arrow-left"></i>
</button>

<h5 class="m-0 fw-semibold mx-auto" id="modeTitle">
Mode
</h5>
</header>

<main class="container py-4">

<div id="levels" class="d-flex flex-column gap-3"></div>

</main>

<script>

/* â­ Mode */
const url = new URLSearchParams(location.search);
let mode = url.get("mode");

/* title */
document.getElementById("modeTitle").innerText =
mode.charAt(0).toUpperCase() + mode.slice(1);

/* progress */
let progress =
JSON.parse(localStorage.getItem("progress")) || {};

/* dynamic JSON */
fetch(`data/${mode}.json`)
.then(res => res.json())
.then(data => {

let html = "";

data.levels.forEach(level => {

let unlocked =
level.level === 1 ||
progress[mode+"_level"+(level.level-1)];

let dots = "";
for(let i=1;i<=3;i++){
  dots +=
  `<div class="dot ${
    unlocked ? 'dot-active' : 'dot-inactive'
  }"></div>`;
}

html += `
<div class="level-card ${unlocked?'':'opacity-75'}"
onclick="${unlocked?`openLevel(${level.level})`:''}">

  <div class="d-flex align-items-center gap-3">

    <div class="level-num ${
      unlocked?'active':'locked'
    }">
      ${level.level}
    </div>

    <div>
      <div class="level-title">
        Level ${level.level}
      </div>
    </div>

  </div>

  <div class="d-flex align-items-center gap-2">

    <div class="d-flex align-items-center">
      ${dots}
    </div>

    ${
      unlocked
      ? `<i class="bi bi-check-circle-fill text-success fs-5"></i>`
      : `<i class="bi bi-lock-fill lock"></i>`
    }

  </div>

</div>
`;
});

document.getElementById("levels").innerHTML = html;

});


/* open */
function openLevel(level){
location.href =
`game.html?mode=${mode}&level=${level}&sub=1`;
}

</script>

</body>
</html>
